# ğŸ…ğŸ»CH4.íšŒì› ê´€ë¦¬ ì˜ˆì œğŸ…ğŸ»

## ğŸ˜‹ë°±ì—”ë“œ ê°œë°œ ë§›ë³´ê¸°ğŸ˜‹ 
1. [ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ì •ë¦¬](#ğŸ-ë¹„ì§€ë‹ˆìŠ¤-ìš”êµ¬ì‚¬í•­-ì •ë¦¬ğŸ)  
2. [íšŒì› ë„ë©”ì¸ê³¼ ë¦¬í¬ì§€í† ë¦¬ ë§Œë“¤ê¸°](#ğŸ-íšŒì›-ë„ë©”ì¸ê³¼-ë¦¬í¬ì§€í† ë¦¬-ë§Œë“¤ê¸°ğŸ)  
3. [íšŒì› ë¦¬í¬ì§€í† ë¦¬ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±](#ğŸ-íšŒì›-ë¦¬í¬ì§€í† ë¦¬-í…ŒìŠ¤íŠ¸-ì¼€ì´ìŠ¤-ì‘ì„±ğŸ)  
4. [íšŒì› ì„œë¹„ìŠ¤ ê°œë°œ](#ğŸ-íšŒì›-ì„œë¹„ìŠ¤-ê°œë°œğŸ)  
5. [íšŒì› ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸](#ğŸ-íšŒì›-ì„œë¹„ìŠ¤-í…ŒìŠ¤íŠ¸ğŸ)  


### ğŸ ë¹„ì§€ë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ì •ë¦¬ğŸ

* ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ì •ë¦¬  
    * ë°ì´í„°: íšŒì›ID, ì´ë¦„  
    * ê¸°ëŠ¥: íšŒì› ë“±ë¡, ì¡°íšŒ  
        * ì•„ì§ ë°ì´í„° ì €ì¥ì†Œê°€ ì„ ì •ë˜ì§€ ì•ŠìŒ  

* ì¼ë°˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ êµ¬ì¡°  
    ![image](https://user-images.githubusercontent.com/77817094/173293312-aeea17a1-2bbc-4c53-8f8c-2b5e126a4af0.png)  
    * ì»¨íŠ¸ë¡¤ëŸ¬: ì›¹ MVCì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì—­í• , APIë§Œë“¤ë•Œë„  
    * ì„œë¹„ìŠ¤: ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì— í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŒ 
        * ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ê°ì²´ë¥¼ ê°€ì§€ê³  ê·¸ ë¡œì§ì„ êµ¬í˜„í•˜ëŠ” ê³„ì¸µ   
    * ë¦¬í¬ì§€í† ë¦¬: ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼, ë„ë©”ì¸ ê°ì²´ë¥¼ DBì— ì €ì¥í•˜ê³  ê´€ë¦¬  
    * ë„ë©”ì¸: ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ê°ì²´  
        * ì˜ˆ) íšŒì›, ì£¼ë¬¸, ì¿ í° ë“±ë“± ì£¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ê³  ê´€ë¦¬ë¨    

* í´ë˜ìŠ¤ ì˜ì¡´ê´€ê³„  
    ![image](https://user-images.githubusercontent.com/77817094/173294250-06909cc1-9cac-41fb-87ae-f8bd797d6872.png)  
    ```
    * ê°œë°œì„ ì§„í–‰í•˜ê¸° ìœ„í•´ì„œ ì´ˆê¸° ê°œë°œ ë‹¨ê³„ì—ì„œëŠ” êµ¬í˜„ì²´ë¡œ ê°€ë²¼ìš´ ë©”ëª¨ë¦¬ ê¸°ë°˜ì˜ ë°ì´í„° ì €ì¥ì†Œ ì‚¬ìš©  

    * ì•„ì§ ë°ì´í„° ì €ì¥ì†Œê°€ ì„ ì •ë˜ì§€ ì•Šì•„ì„œ, ìš°ì„  ì¸í„°í˜ì´ìŠ¤ë¡œ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„  
     -> ë‚˜ì¤‘ì— êµ¬ì²´ì ì¸ ê¸°ìˆ ì´ ì„ ì •ì´ ë˜ë©´ ë°”ê¿” ë¼ìš¸ ìˆ˜ ìˆê²Œ interface ì •ì˜í•¨.  

    * ë°ì´í„° ì €ì¥ì†ŒëŠ” RDB, NoSQL ë“±ë“± ë‹¤ì–‘í•œ ì €ì¥ì†Œë¥¼ ê³ ë¯¼ì¤‘ì¸ ìƒí™©ìœ¼ë¡œ ê°€ì •
    ```
### ğŸ íšŒì› ë„ë©”ì¸ê³¼ ë¦¬í¬ì§€í† ë¦¬ ë§Œë“¤ê¸°ğŸ  

> 1. íšŒì› ë§Œë“¤ê³   
> 3. ê·¸ íšŒì›ë“¤ ì €ì¥í•˜ëŠ” repository ë©”ëª¨ë¦¬ ë§Œë“¤ê³   
> 2. ë‚˜ì¤‘ì„ ìœ„í•´ì„œ repository ì¸í„°í˜ì´ìŠ¤ ë§Œë“¤ê³ !  
> ëâ€¼


â˜ğŸ». domain íŒ¨í‚¤ì§€ì— íšŒì› class ìƒì„± - ê°ì²´  
![image](https://user-images.githubusercontent.com/77817094/174017489-61440d1a-cf39-460a-9307-de951b85b753.png)  
    
```java
package hello.hellospring.domain;

public class Member {

    private Long id;
    //ì‹œìŠ¤í…œì´ ì •í•´ì£¼ëŠ”ê±°
    private String name;
    //íšŒì›ì´ ë¡œê·¸ì¸í• ë•Œ ì ëŠ”ê±°
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}

```

âœŒğŸ». íšŒì› repository interface ìƒì„±   
![image](https://user-images.githubusercontent.com/77817094/174018506-9ef55c43-0d0c-40e1-81bb-f69b67c0960a.png)  

```java
package hello.hellospring.repository;

import hello.hellospring.domain.Member;

import java.util.List;
import java.util.Optional;

public interface MemberRepository {
    Member save (Member member);
    //ì €ì¥ëœ íšŒì› ë°˜í™˜
    Optional<Member> findById(Long id);
    //idë¡œ íšŒì›ì°¾ëŠ” ê¸°ëŠ¥
    //optionalì€ ìë°”8ì— ë“¤ì–´ê°„ ê¸°ëŠ¥ - idê°€ nullì¸ ê²½ìš°ë¥¼ ìœ„í•´
    Optional<Member> findByName(String name);
    //nameìœ¼ë¡œ íšŒì›ì°¾ëŠ” ê¸°ëŠ¥
    List<Member> findAll();
    //ì§€ê¸ˆê¹Œì§€ ì €ì¥í•œ ëª¨ë“  íšŒì›ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•´ì¤Œ
}
```   

ğŸ‘ŒğŸ». íšŒì› repository ë©”ëª¨ë¦¬ ìƒì„±(êµ¬í˜„)   
![image](https://user-images.githubusercontent.com/77817094/174019234-5196ed8c-eef3-4283-ab4f-4c2d3df9c708.png)   
```java
package hello.hellospring.repository;

import hello.hellospring.domain.Member;

import java.util.*;

//ë’¤ì— implements MemberRepository ì“°ê³  Alt+Enter ëˆ„ë¥´ë©´
//implement method í•  ìˆ˜ ìˆìŒ. (ë’¤ì— override) ì¬ë„¤ ìƒê¹€.
public class MemoryMemberRepository implements MemberRepository {

    private static Map<Long, Member> store = new HashMap<>();
    //ì €ì¥í•  ê³³ = map
    //ì‹¤ë¬´ì—ì„œëŠ” í•´ì‰¬ë§µ ë™ì‹œì„±ë¬¸ì œë•œì— ì˜ ì•ˆì“°ê¸´ í•¨.
    private static long sequence = 0L;
    //ì‹œí€€ìŠ¤ëŠ” 0,1,2ì´ëŸ°ì‹ìœ¼ë¡œ í‚¤ê°’ ì €ì¥í•´ì£¼ëŠ” ì• ë¼ê³  ë³´ë©´ë¨

    @Override
    public Member save(Member member) {
        member.setId(++sequence);
        //sequence ê°’ ì˜¬ë ¤ì¤˜ì„œ id ì„¸íŒ…í•´ì¤Œ
        store.put(member.getId(), member);
        //ìŠ¤í† ì–´ì— ì €ì¥í•˜ë©´ map ì— ì €ì¥ë¨.
        return member;
    }

    @Override
    public Optional<Member> findById(Long id) {
        return Optional.ofNullable(store.get(id));
        //ì›ë˜ store.get(id)ì¸ë°, null ì´ ë°˜í™˜ë  ê°€ëŠ¥ì„±ì´ ìˆì–´ì„œ
        // Optional.ofNullable()ë¡œ ê°ì‹¸ì¤Œ.
    }

    @Override
    public Optional<Member> findByName(String name) {
        return store.values().stream()
                .filter(member -> member.getName().equals(name))
                .findAny();
        //findAny()ì˜ ê²°ê³¼ê°€ optional ë¡œ ë°˜í™˜ë¨.
        //ë§µì—ì„œ ëŒë©´ì„œ ì´ë¦„ ê°’ì€ì•  ì°¾ê³  ëª»ì°¾ìœ¼ë©´ ë„ê°’ì´ í¬í•¨ë˜ë©´ì„œ ë°˜í™˜
    }

    @Override
    public List<Member> findAll() {
        return new ArrayList<>(store.values());
        //ìŠ¤í† ì–´ì— ìˆëŠ” ë©¤ë²„ë“¤ì„ ë°˜í™˜í•¨.
    }
}
```   

### ğŸ íšŒì› ë¦¬í¬ì§€í† ë¦¬ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±ğŸ  
íšŒì› repository ë©”ëª¨ë¦¬ êµ¬í˜„ì²´ í…ŒìŠ¤íŠ¸
![image](https://user-images.githubusercontent.com/77817094/174022437-04a8622c-a1e1-4728-9eaf-e98f16685587.png)  

* ğŸ’¦ì €ì¥ì´ ì œëŒ€ë¡œ ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸ğŸ’¦
```java
package hello.hellospring.repository;

import hello.hellospring.domain.Member;
import org.junit.jupiter.api.Test;

public class MemoryMemberRepositoryTest {

    MemoryMemberRepository repository = new MemoryMemberRepository();

    @Test //2. ì´ê±¸ ì‘ì„±í•´ì¤˜ì•¼í•¨.
    public void save(){
        //1. ì´ ê¸°ëŠ¥ì´ ë™ì‘í•˜ëŠ”ì§€ ë³´ë ¤ë©´
        //3. ì„±ê³µí•˜ë©´ ì´ˆë¡ë¶ˆ ëœ¸.
        Member member = new Member();
        member.setName("spring");

        repository.save(member);
        //ë©¤ë²„ ì €ì¥í•˜ëŠ”ê±°
        Member result = repository.findById(member.getId()).get();
        //ì œëŒ€ë¡œ ë“¤ì–´ê°”ë‚˜ ê²€ì¦í•˜ê¸° ìœ„í•´ resultì— ìš°ì„  ì €ì¥.
        System.out.println("result = " + (result == member));
        //DBì—ì„œ êº¼ë‚¸ê±°ë‘ newë¡œ ë§Œë“ ê±°ë‘ ë˜‘ê°™ìœ¼ë©´ ì„±ê³µ!
    }

}
```    
* ì‹¤í–‰ ê²°ê³¼     
![image](https://user-images.githubusercontent.com/77817094/174022835-6544c566-5cf9-4613-9fe7-8e7a0fb0658c.png)   
-> ì´ë ‡ê²Œ ë‚˜ì˜¤ëŠ”ë° ë§¤ë²ˆ ì¶œë ¥ ê°’ì„ ë³¼ ìˆ˜ëŠ” ì—†ìœ¼ë‹ˆê¹Œ 'assertions' ë¼ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤.     

```java 
//System.out.println("result = " + (result == member));
Assertions.assertEquals(result,member);
```   
* ë˜‘ê°™ì„ ê²½ìš°.  
![image](https://user-images.githubusercontent.com/77817094/174023890-2ddd4c74-b2c1-4841-aab7-1eaf11af6228.png)  

* ë‹¤ë¥¼ ê²½ìš°.  
![image](https://user-images.githubusercontent.com/77817094/174023983-cd2b9f42-ffe1-4f08-9bee-dac7454a7dc1.png)  

ìš”ìƒˆëŠ” ì´ ë¬¸ë²• ë§ì´ ì”€.  
```java
//System.out.println("result = " + (result == member));
//Assertions.assertEquals(result,null);
Assertions.assertThat(member).isEqualTo(result);
//ìš”ìƒˆëŠ” ì´ê±° ë§ì´ ì”€
```  
Assertionë’¤ì—ì„œ ì˜µì…˜ ì—´ë©´ (alt + enter) static import í•  ìˆ˜ ìˆìŒ.  

```java
import static org.assertj.core.api.Assertions.*;
// ì¶”ê°€ ë˜ì—ˆìœ¼ë¯€ë¡œ 
assertThat(member).isEqualTo(result);  
//ë¡œ ì“¸ ìˆ˜ ìˆë‹¤.
```  

* ğŸ’¦ì´ë¦„ìœ¼ë¡œ ì°¾ì•„ì£¼ëŠ” í…ŒìŠ¤íŠ¸ğŸ’¦  
```java
@Test
public void findByName() {
    //ë©¤ë²„ ë‘ê°œ ìƒì„±í•œ ë’¤
    Member member1 = new Member();
    member1.setName("spring1");
    repository.save(member1);

    Member member2 = new Member();
    member2.setName("spring2");
    repository.save(member2);

    //when
    Member result = repository.findByName("spring1").get();
    //then
    assertThat(result).isEqualTo(member1);
    //ì‹¤í–‰ê²°ê³¼ = ì°¸
    assertThat(result).isEqualTo(member2);
    //ì‹¤í–‰ê²°ê³¼ = ê±°ì§“(ì•ˆë¨)
}
```

* ğŸ’¦ë¦¬ìŠ¤íŠ¸ ëª‡ëª…ì¸ì§€ ì°¾ì•„ì£¼ëŠ” í…ŒìŠ¤íŠ¸ğŸ’¦  
```java  
@Test
public void findAll() {
    //ë©¤ë²„ ë‘ê°œ ìƒì„±í•œ ë’¤
    Member member1 = new Member();
    member1.setName("spring1");
    repository.save(member1);

    Member member2 = new Member();
    member2.setName("spring2");
    repository.save(member2);

    //when
    List<Member> result = repository.findAll();
    //then
    assertThat(result.size()).isEqualTo(2);
    //ì‹¤í–‰ê²°ê³¼ = ì°¸
    assertThat(result.size()).isEqualTo(3);
    //ì‹¤í–‰ê²°ê³¼ = ê±°ì§“(ì•ˆë¨)
    }
```

* â‰ ë¬¸ì œ ë°œìƒ â‰  
![image](https://user-images.githubusercontent.com/77817094/174252231-d9336664-e87a-4d02-9caa-b6b1439282bd.png)  

    > ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ classë‹¨ìœ„ë¡œ runì„ í•˜ê²Œë˜ë©´ í…ŒìŠ¤íŠ¸ë“¤ì— ìˆëŠ” ê°ì²´ê°€ ì´ë¦„ì´ ê°™ìœ¼ë©´ (ë‹¤ë¥¸ì•  ê¸°ì¤€ ë¨¼ì € ì •ì˜ëœ ì• ê°€ ìˆìœ¼ë©´) ì‹¤í–‰ì˜¤ë¥˜ê°€ ëœ¬ë‹¤. ë”°ë¼ì„œ testê°€ í•˜ë‚˜ ëë‚ ë•Œë§ˆë‹¤ ë©”ëª¨ë¦¬ë¥¼ ë¦¬ì…‹í•´ì¤˜ì•¼í•œë‹¤. = ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì§€ì›Œì£¼ëŠ” ì½”ë“œ ë„£ê¸°.  

* ê¸°ëŠ¥ ìœ„ì¹˜  
![image](https://user-images.githubusercontent.com/77817094/174253843-7288a662-f0a7-4d82-9355-39e87a823dbd.png)  

```java  
@Override
public List<Member> findAll() {
    return new ArrayList<>(store.values());
    //ìŠ¤í† ì–´ì— ìˆëŠ” ë©¤ë²„ë“¤ì„ ë°˜í™˜í•¨.
}

// ì—¬ê¸°ì— ì¶”ê°€í•´ì£¼ê¸°
public void clearStore() {
    store.clear();
}
```
* ì‹¤í–‰ ìœ„ì¹˜  
![image](https://user-images.githubusercontent.com/77817094/174254443-2c08f426-8c1a-4a1b-89ee-f5fa6847bb79.png)  

```java

```
### ğŸ íšŒì› ì„œë¹„ìŠ¤ ê°œë°œğŸ

### ğŸ íšŒì› ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ğŸ
